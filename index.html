<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Home - SDN Sidobandung II</title>

<style>
body{
  margin:0;
  font-family:system-ui, Arial, sans-serif;
  text-align:center;
  color:#0f172a;
  display:flex;
  flex-direction:column;
  align-items:center;
  min-height:100vh;
  padding:20px;
  background:linear-gradient(160deg,#ffe0b2,#ffb74d,#ff9800);
}

header img{
  width:160px;
  height:160px;
  object-fit:contain;
  margin-bottom:16px;
  border-radius:50%;
  background:linear-gradient(160deg,#d50000,#ff5252,#ffffff);
  box-shadow:0 4px 12px rgba(0,0,0,.15);
}

h1{
  font-size:clamp(20px,5vw,30px);
  margin:0 0 24px;
  font-weight:700;
}

.menu{
  width:100%;
  max-width:360px;
  margin-bottom:24px;
}

.menu a{
  display:block;
  padding:16px;
  border-radius:14px;
  text-decoration:none;
  font-weight:600;
  font-size:16px;
  color:#fff;
  background:#0284c7;
  box-shadow:0 6px 16px rgba(2,132,199,.35);
}

.menu a:active{transform:scale(.97)}

/* ===== PENGUMUMAN ===== */
.pengumuman{
  width:100%;
  max-width:360px;
  background:#fff;
  border-radius:14px;
  padding:16px;
  box-shadow:0 6px 18px rgba(0,0,0,.15);
  text-align:left;
}

.pengumuman h2{
  margin:0 0 10px;
  font-size:18px;
  text-align:center;
}

.tanggal{
  font-size:12px;
  color:#555;
  text-align:center;
  margin-bottom:10px;
}

.pengumuman img{
  width:100%;
  max-height:360px;      /* ‚¨ÖÔ∏è LEBIH BESAR */
  object-fit:contain;
  margin:12px 0;
  border-radius:10px;
  cursor: zoom-in;       /* ‚¨ÖÔ∏è PETUNJUK BISA DI ZOOM */
}

.judul{
  font-weight:700;
  font-size:18px;
  margin-bottom:6px;
}


.loading{
  text-align:center;
  color:#666;
  font-size:14px;
}

.isi{
  font-size:18px;
  line-height:1.6;
  white-space: pre-line; /* ‚¨ÖÔ∏è INI KUNCINYA */
}


#imgOverlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.9);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}

#imgOverlay img{
  max-width:95%;
  max-height:95%;
  object-fit:contain;
  cursor: zoom-out;
}


</style>
</head>

<div id="imgOverlay" onclick="this.style.display='none'">
  <img id="imgFull">
</div>

<body>

<header>
  <img src="https://i.imgur.com/RruvYpK.jpeg" alt="Logo Sekolah">
</header>

<h1>Portal Siswa SDN Sidobandung II</h1>

<nav class="menu">
  <a href="https://addfast2025.github.io/Admin/lapor_subuh_2026.html">
    üìñ Lapor Subuh
  </a>
</nav>

<!-- ===== PENGUMUMAN ===== -->
<section class="pengumuman" id="pengumumanBox">
  <h2>üì¢ Pengumuman</h2>
  <div class="loading">Memuat pengumuman...</div>
</section>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, collection, query, where,
  orderBy, limit, getDocs
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ===== FIREBASE ===== */
const firebaseConfig = {
  apiKey:"AIzaSyD8SIXXPm_c-TJiaRjHbrishFtU2NICm9M",
  authDomain:"datasiswa-c10f4.firebaseapp.com",
  projectId:"datasiswa-c10f4"
};



const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ===== LEMBAGA FIX ===== */
const lembagaId = "kVMG9kghdBegwrtjxbuX";


function openImage(src){
  const overlay = document.getElementById("imgOverlay");
  const img = document.getElementById("imgFull");
  img.src = src;
  overlay.style.display = "flex";
}



</script>





<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, collection, query, where,
  orderBy, limit, getDocs
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ===== FIREBASE ===== */
const firebaseConfig = {
  apiKey:"AIzaSyD8SIXXPm_c-TJiaRjHbrishFtU2NICm9M",
  authDomain:"datasiswa-c10f4.firebaseapp.com",
  projectId:"datasiswa-c10f4"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);


function driveThumb(url, size = 600){
  if(!url) return "";
  if(url.includes("thumbnail")) return url;

  if(url.includes("uc?id=")){
    return url.replace(
      "https://drive.google.com/uc?id=",
      "https://drive.google.com/thumbnail?id="
    ) + "&sz=w" + size;
  }

  return url;
}





/* ===== LEMBAGA FIX ===== */
const lembagaId = "kVMG9kghdBegwrtjxbuX";

/* ===== LOAD PENGUMUMAN TERBARU ===== */
async function loadPengumuman(){
  const box = document.getElementById("pengumumanBox");
  box.innerHTML = `<div class="loading">Memuat pengumuman...</div>`;

  try{
    const q = query(
      collection(db,"pengumuman"),
      where("lembagaId","==",lembagaId),
      orderBy("dibuat","desc"),
      limit(1)
    );

    const snap = await getDocs(q);

    if(snap.empty){
      box.innerHTML = `<div class="loading">Belum ada pengumuman</div>`;
      return;
    }

    const d = snap.docs[0];
    const x = d.data();
    // ‚ùå Jika judul = 0 ‚Üí jangan tampilkan pengumuman sama sekali
if (x.judul === "0" || x.judul === 0) {
  box.style.display = "none";
  return;
}

    const tgl = x.dibuat?.toDate
      ? x.dibuat.toDate().toLocaleDateString("id-ID")
      : "";

    box.innerHTML = `
      <h2>üì¢ Pengumuman</h2>
      ${tgl ? `<div class="tanggal">${tgl}</div>` : ``}
      <div class="judul">${x.judul}</div>
  <img src="${driveThumb(x.foto,800)}" onclick="openImage(this.src)">


      <div class="isi">${x.isi}</div>
    `;

  }catch(err){
    console.error("ERROR PENGUMUMAN:", err);

    box.innerHTML = `
      <div class="loading">
        ‚ö†Ô∏è Pengumuman belum bisa dimuat<br>
        (index Firestore belum dibuat)
      </div>
    `;
  }
}

loadPengumuman();
</script>






</body>
</html>

